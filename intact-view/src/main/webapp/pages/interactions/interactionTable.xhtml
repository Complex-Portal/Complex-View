<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"

                xmlns:iamf="http://intact.ebi.ac.uk/mitabfunctions"
                xmlns:iav="http://intact.ebi.ac.uk/view"
                xmlns:iam="http://intact.ebi.ac.uk/miscel"

                xmlns:iv="http://java.sun.com/jsf/composite/intactview">


<p:dialog id="updateColumns" header="Columns displayed" widgetVar="columnsDialog" width="300" height="450">
    Select:
    <p:commandLink id="selectMinimalColumns" value="Minimal" actionListener="#{columnContext.selectMininumColumns()}"
                   update="columnSelection" process="@this" partialSubmit="true" onstart="statusDialog.show()"
                   oncomplete="statusDialog.hide()"/>
    &#160;|&#160;
    <p:commandLink id="selectBasicColumns" value="Basic" actionListener="#{columnContext.selectBasicColumns()}"
                   update="columnSelection" process="@this" partialSubmit="true" onstart="statusDialog.show()"
                   oncomplete="statusDialog.hide()"/>
    &#160;|&#160;
    <p:commandLink id="selectStandardColumns" value="Standard" actionListener="#{columnContext.selectStandardColumns()}"
                   update="columnSelection" process="@this" partialSubmit="true" onstart="statusDialog.show()"
                   oncomplete="statusDialog.hide()"/>
    &#160;|&#160;
    <p:commandLink id="selectExpandedColumns" value="Expanded" actionListener="#{columnContext.selectExpandedColumns()}"
                   update="columnSelection" process="@this" partialSubmit="true" onstart="statusDialog.show()"
                   oncomplete="statusDialog.hide()"/>
    &#160;|&#160;
    <p:commandLink id="selectCompleteColumns" value="Complete" actionListener="#{columnContext.selectCompleteColumns()}"
                   update="columnSelection" process="@this" partialSubmit="true" onstart="statusDialog.show()"
                   oncomplete="statusDialog.hide()"/>
    <hr/>

    <div style="height:300px; width: 100%;overflow-x: auto;">
        <h:selectManyCheckbox id="columnSelection" value="#{columnContext.selectedColumns}" layout="pageDirection">
            <f:selectItems value="#{columnContext.columnsSelectItems}"/>
        </h:selectManyCheckbox>
    </div>
    <hr/>
    <p:commandButton id="updateColumnSelection" value="Update"
                     update="resultsTable"
                     oncomplete="columnsDialog.hide(); statusDialog.hide()"
                     onstart="statusDialog.show()"
                     process="columnSelection" ajax="true" partialSubmit="true"/>
</p:dialog>

<p:toolbar rendered="#{searchBean.totalResults > 0}">

    <p:toolbarGroup align="left">

        <h:selectOneMenu id="exportFormatSelect"
                         value="#{searchBean.exportFormat}">
            <p:ajax event="change" onstart="statusDialog.show()"
                    update="exportBtn" oncomplete="statusDialog.hide()"/>
            <f:selectItem itemLabel=" Select format to Download " itemValue="#{null}"/>
            <f:selectItem itemLabel="MI-TAB 2.5" itemValue="mitab_25"
                          onclick="_gaq.push(['_trackEvent', 'Export', 'MI-TAB', ''])"/>
            <f:selectItem itemLabel="MI-TAB 2.6" itemValue="mitab_26"/>
            <f:selectItem itemLabel="MI-TAB 2.7" itemValue="mitab_27"/>
            <f:selectItem itemLabel="MI-XML 2.5.3" itemValue="xml_2_53" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="MI-XML 2.5.4" itemValue="xml_2_54" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="MI-XML 2.5(HTML view)" itemValue="xml_html"
                          itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="BioPAX (Level 3)" itemValue="biopax_l3" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="BioPAX (Level 2)" itemValue="biopax_l2" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="RDF/XML" itemValue="rdf_xml" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="RDF/XML (Abbrev)" itemValue="rdf_xml_abbrev" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="RDF (N3)" itemValue="rdf_n3" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="RDF (N-Triples)" itemValue="rdf_triple" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="RDF (Turtle)" itemValue="rdf_turtle" itemDisabled="#{searchBean.totalResults ge intactViewConfiguration.maxSizeXmlExport}"/>
            <f:selectItem itemLabel="XGMML (Cytoscape)" itemValue="xgmml"/>
        </h:selectOneMenu>


        <p:commandButton type="button" id="exportBtn" value="Download"
                         disabled="#{searchBean.exportFormat == null}"
                         process="@this"
                         rendered="#{searchBean.results != null}"
                         onclick="var selector = document.getElementById('mainPanels:exportFormatSelect');_gaq.push(['_trackEvent', 'Export', selector.options[selector.selectedIndex].text,'#{userQuery.searchQuery}']); var newWindow = window.open('#{requestConfigBean.absoluteContextPath}/export?#{searchBean.exportQueryParameters}', '_blank'); newWindow.focus()"/>
        <p:separator/>

        <p:commandButton process="@this" id="customizedViewButton" type="button" value="Customize view" onclick="columnsDialog.show(); _gaq.push(['_trackEvent', 'Interactions table', 'Customize view', '#{userQuery.searchQuery}'])" />
    </p:toolbarGroup>
</p:toolbar>

<br/>

<iv:cvLazyDialog dialogVar="cvInfoDialog"/>


<p:dataTable id="resultsTable" var="binaryInteraction" value="#{searchBean.results}"
             rows="#{userQuery.pageSize}"
             dynamic="true" rowIndexVar="row"
             paginatorPosition="top"
             paginatorAlwaysVisible="true"
             paginator="#{searchBean.results.rowCount gt userQuery.pageSize}"
             rowStyleClass="#{searchBean.results.negative? ', negativeInteractionRow' : ''}"
             rendered="#{searchBean.results != null and searchBean.results.rowCount > 0}"
        >

<p:column id="firstExpToggler">
    <p:rowToggler/>
</p:column>

<p:column id="detailCol">
    <f:facet name="header">
        <h:outputText value="Dts"/>
    </f:facet>
    <h:link outcome="/pages/details/details.xhtml?faces-redirect=true&amp;includeViewParams=true&amp;interactionAc=#{searchBean.getMainAccessionXref(binaryInteraction).identifier}&amp;kmr=true">
        <h:graphicImage url="/images/magnify.png" alt="details"/>
    </h:link>
</p:column>
<p:column id="numberRowCol">
    <f:facet name="header" data-hide="phone,tablet">
        <h:outputText value="#"/>
    </f:facet>
    <h:outputText value="#{row + 1}"/>
</p:column>

<p:column id="moleculeACol" rendered="#{columnContext.isColumnVisible('moleculeA.name')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeA.name']}"/>
    </f:facet>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious}">
        <h:outputText value="#{iamf:getInteractorDisplayName(binaryInteraction.interactorA)}"/>
    </h:panelGroup>
</p:column>

<p:column id="linksACol" rendered="#{columnContext.isColumnVisible('moleculeA.links')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeA.links']}"/>
    </f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null and not searchBean.results.sameThanPrevious}">
        <iv:interactorLinkLogos interactor="#{binaryInteraction.interactorA}"
                                display="#{not searchBean.results.sameThanPrevious}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorA == null and not searchBean.results.sameThanPrevious}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="moleculeBCol" rendered="#{columnContext.isColumnVisible('moleculeB.name')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeB.name']}"/>
    </f:facet>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious}">

        <h:outputText value="#{iamf:getInteractorDisplayName(binaryInteraction.interactorB)}"/>
    </h:panelGroup>
</p:column>

<p:column id="linksBCol" styleClass="cellTextCompound"
          rendered="#{columnContext.isColumnVisible('moleculeB.links')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeB.links']}"/>
    </f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorB != null and not searchBean.results.sameThanPrevious}">
        <iv:interactorLinkLogos interactor="#{binaryInteraction.interactorB}"
                                display="#{not searchBean.results.sameThanPrevious}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null and not searchBean.results.sameThanPrevious}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="uniqueIdACol" rendered="#{columnContext.isColumnVisible('moleculeA.uniqueId')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeA.uniqueId']}"/>
    </f:facet>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA != null}">
        <iam:collapsibleIterator disclosed="true"
                                 value="#{binaryInteraction.interactorA.identifiers}"
                                 maxShown="1">
            <h:outputText value="#{item.identifier}" style="white-space:nowrap;"/>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="uniqueIdBCol" rendered="#{columnContext.isColumnVisible('moleculeB.uniqueId')}">
    <f:facet name="header">
        <h:outputText value="#{messages['moleculeB.uniqueId']}"/>
    </f:facet>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB != null}">
        <iam:collapsibleIterator disclosed="true"
                                 value="#{binaryInteraction.interactorB.identifiers}"
                                 maxShown="1">
            <h:outputText value="#{item.identifier}" style="white-space:nowrap;"/>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="aliasesACol" styleClass="cellTextCompound"
          rendered="#{columnContext.isColumnVisible('moleculeA.aliases')}">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.aliases']}"/></f:facet>

    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{iamf:getExclusionFilteredAliases(binaryInteraction.interactorA.aliases)}"
                                 maxShown="3">
            <span style="display:block">
                <h:outputText value="#{item.name}"/>
            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="aliasesBCol" styleClass="cellTextCompound"
          rendered="#{columnContext.isColumnVisible('moleculeB.aliases')}">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.aliases']}"/></f:facet>

    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{iamf:getExclusionFilteredAliases(binaryInteraction.interactorB.aliases)}"
                                 maxShown="3">
            <span style="display:block">
                <h:outputText value="#{item.name}"/>
            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="speciesACol" styleClass="cellTextCompound"
          rendered="#{columnContext.isColumnVisible('moleculeA.species')}">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.species']}"/></f:facet>

    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious}">
        <h:panelGroup rendered="#{iamf:hasOrganism(binaryInteraction.interactorA)}">
            <ui:include src="/pages/interactions/organismXrefs.xhtml">
                <ui:param name="xref"
                          value="#{iamf:getUniqueOrganismXref(binaryInteraction.interactorA.organism.identifiers)}"/>
            </ui:include>
        </h:panelGroup>
        <h:panelGroup rendered="#{not iamf:hasOrganism(binaryInteraction.interactorA)}">
            N/A
        </h:panelGroup>
    </h:panelGroup>
</p:column>

<p:column id="speciesBCol" styleClass="cellTextCompound"
          rendered="#{columnContext.isColumnVisible('moleculeB.species')}">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.species']}"/></f:facet>

    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious}">
        <h:panelGroup rendered="#{iamf:hasOrganism(binaryInteraction.interactorB)}">
            <ui:include src="/pages/interactions/organismXrefs.xhtml">
                <ui:param name="xref"
                          value="#{iamf:getUniqueOrganismXref(binaryInteraction.interactorB.organism.identifiers)}"/>
            </ui:include>
        </h:panelGroup>
        <h:panelGroup rendered="#{not iamf:hasOrganism(binaryInteraction.interactorB)}">
            N/A
        </h:panelGroup>
    </h:panelGroup>
</p:column>

<p:column id="dethMethodCol" rendered="#{columnContext.isColumnVisible('interaction.detectionmethod')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.detectionmethod']}"/></f:facet>
    <iv:cvLazyPopup text="#{binaryInteraction.detectionMethods[0].text}" dialogVar="cvInfoDialog"
                    cvClassName="uk.ac.ebi.intact.model.CvInteraction"
                    cvIdentifier="#{binaryInteraction.detectionMethods[0].identifier}"/>
</p:column>

<p:column id="typeCol" rendered="#{columnContext.isColumnVisible('interaction.interactiontype')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.interactiontype']}"/></f:facet>
    <iv:cvLazyPopup text="#{binaryInteraction.interactionTypes[0].text}" dialogVar="cvInfoDialog"
                    cvClassName="uk.ac.ebi.intact.model.CvInteractionType"
                    cvIdentifier="#{binaryInteraction.interactionTypes[0].identifier}"/>
</p:column>

<p:column id="confCol" rendered="#{columnContext.isColumnVisible('interaction.confidencevalue')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.confidencevalue']}"/></f:facet>
    <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious}">
        <ui:repeat var="confidence" value="#{binaryInteraction.confidenceValues}" rows="0">
                            <span style="display:block">
                                    <strong><h:outputText value="#{confidence.type}"
                                                          style="white-space:nowrap"/></strong>
                                    <h:outputText value=" : #{confidence.value}" style="white-space:nowrap"/>
                            </span>
        </ui:repeat>
    </h:panelGroup>
</p:column>


<p:column id="exproleACol" rendered="#{columnContext.isColumnVisible('moleculeA.exprole')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.exprole']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorA.experimentalRoles[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvExperimentalRole"
                        cvIdentifier="#{binaryInteraction.interactorA.experimentalRoles[0].identifier}"/>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>
<p:column id="exproleBCol" rendered="#{columnContext.isColumnVisible('moleculeB.exprole')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.exprole']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorB.experimentalRoles[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvExperimentalRole"
                        cvIdentifier="#{binaryInteraction.interactorB.experimentalRoles[0].identifier}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="typeACol" rendered="#{columnContext.isColumnVisible('moleculeA.interactortype')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.interactortype']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorA.interactorTypes[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvInteractorType"
                        cvIdentifier="#{binaryInteraction.interactorA.interactorTypes[0].identifier}"/>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>
<p:column id="typeBCol" rendered="#{columnContext.isColumnVisible('moleculeB.interactortype')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.interactortype']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorB.interactorTypes[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvInteractorType"
                        cvIdentifier="#{binaryInteraction.interactorB.interactorTypes[0].identifier}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="hostCol" styleClass="cellTextInteraction"
          rendered="#{columnContext.isColumnVisible('interaction.hostorganism')}">
    <f:facet name="header"><h:outputText value="#{messages['interaction.hostorganism']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.hostOrganism != null}">
        <ui:include src="/pages/interactions/organismXrefs.xhtml">
            <ui:param name="xref" value="#{iamf:getUniqueOrganismXref(binaryInteraction.hostOrganism.identifiers)}"/>
        </ui:include>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.hostOrganism == null}">
        N/A
    </h:panelGroup>
</p:column>

<p:column id="parametersCol" rendered="#{columnContext.isColumnVisible('interaction.parameters')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.parameters']}"/></f:facet>
    <ui:repeat var="parameter" value="#{binaryInteraction.parameters}" rows="0">
                           <span style="display:block">
                                    <strong><h:outputText value="#{parameter.type}"
                                                          style="white-space:nowrap"/></strong>
                                    <h:outputText value=" : #{iamf:getParameter(parameter)}"
                                                  style="white-space:nowrap"/>
                            </span>
    </ui:repeat>
</p:column>


<p:column id="negativeCol" rendered="#{columnContext.isColumnVisible('interaction.negative')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.negative']}"/></f:facet>
    <h:outputText value="no" style="white-space:nowrap" rendered="#{not binaryInteraction.negativeInteraction}"/>
    <h:outputText value="yes" style="white-space:nowrap" rendered="#{binaryInteraction.negativeInteraction}"/>
</p:column>


<p:rowExpansion id="firstRowExp">
<p:dataTable id="secondTable" value="binaryInteraction">
    <p:column id="altidACol" rendered="#{columnContext.isColumnVisible('moleculeA.alternativeId')}">
        <f:facet name="header">
            <h:outputText value="#{messages['moleculeA.alternativeId']}"/>
        </f:facet>
        <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA != null}">
            <iam:collapsibleIterator disclosed="false"
                                     value="#{binaryInteraction.interactorA.alternativeIdentifiers}"
                                     maxShown="3">
                <h:outputText value="#{item.identifier}" style="white-space:nowrap;"/>
            </iam:collapsibleIterator>
        </h:panelGroup>
        <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorA == null}">
            <h:outputText value="N/A"/>
        </h:panelGroup>
    </p:column>

    <p:column id="altidBCol" rendered="#{columnContext.isColumnVisible('moleculeB.alternativeId')}">
        <f:facet name="header">
            <h:outputText value="#{messages['moleculeB.alternativeId']}"/>
        </f:facet>
        <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB != null}">
            <iam:collapsibleIterator disclosed="false"
                                     value="#{binaryInteraction.interactorB.alternativeIdentifiers}"
                                     maxShown="3">
                <h:outputText value="#{item.identifier}" style="white-space:nowrap;"/>
            </iam:collapsibleIterator>
        </h:panelGroup>
        <h:panelGroup rendered="#{not searchBean.results.sameThanPrevious and binaryInteraction.interactorB == null}">
            <h:outputText value="N/A"/>
        </h:panelGroup>
    </p:column>

    <p:column id="pubAuthCol" rendered="#{columnContext.isColumnVisible('interaction.firstauthor')}"
              styleClass="cellTextInteraction">
        <f:facet name="header"><h:outputText value="#{messages['interaction.firstauthor']}"/></f:facet>

        <ui:repeat var="author" value="#{binaryInteraction.authors}">
                        <span style="display:block">
                                <h:outputText value="#{author.name}" style="white-space:nowrap;"/>
                        </span>
        </ui:repeat>
    </p:column>

    <p:column id="pubIdCol" rendered="#{columnContext.isColumnVisible('interaction.pubmedid')}"
              styleClass="cellTextInteraction">
        <f:facet name="header"><h:outputText value="#{messages['interaction.pubmedid']}"/></f:facet>
        <iav:xrefDataList value="#{binaryInteraction.publications}" itemPerLine="true"/>
    </p:column>

    <p:column id="sourceCol" rendered="#{columnContext.isColumnVisible('interaction.sourcedb')}"
              styleClass="cellTextInteraction">
        <f:facet name="header"><h:outputText value="#{messages['interaction.sourcedb']}"/></f:facet>
        <iav:xrefDataList value="#{binaryInteraction.sourceDatabases}" itemPerLine="true" onlyText="true"/>
    </p:column>

    <p:column id="interactionAcCol" rendered="#{columnContext.isColumnVisible('interaction.ac')}"
              styleClass="cellTextInteraction">
        <f:facet name="header"><h:outputText value="#{messages['interaction.ac']}"/></f:facet>
        <iav:xrefDataList value="#{binaryInteraction.interactionAcs}" itemPerLine="true"/>
    </p:column>

</p:dataTable>
<p:dataTable id="thirdTable" value="binaryInteraction">


<p:column id="expansionCol" rendered="#{columnContext.isColumnVisible('interaction.expansionmethod')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.expansionmethod']}"/></f:facet>
    <p:commandLink type="button" onclick="complexExpansionDialog.show()"
                   value="#{iamf:getExpansionName(binaryInteraction)}"/>
</p:column>


<p:column id="featureACol" rendered="#{columnContext.isColumnVisible('moleculeA.features')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.features']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorA.features}"
                                 maxShown="3">
            <span style="display:block">
                <strong><h:outputText value="#{item.featureType}"/></strong>
                <h:panelGroup rendered="#{not empty item.ranges}">
                    <h:outputText value=" : " style="white-space:nowrap"/>
                    <ui:repeat var="range" value="#{item.ranges}">
                           <span style="display:block">
                                    <strong><h:outputText value="#{checksum.methodName}"
                                                          style="white-space:nowrap"/></strong>
                          <h:outputText value="#{range}" style="white-space:nowrap"/>
                               <br/>
                          </span>
                    </ui:repeat>
                </h:panelGroup>
            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="featureBCol" rendered="#{columnContext.isColumnVisible('moleculeB.features')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.features']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorB.features}"
                                 maxShown="3">
            <span style="display:block">
                <strong><h:outputText value="#{item.featureType}"/></strong>
                <h:panelGroup rendered="#{not empty item.ranges}">
                    <h:outputText value=" : " style="white-space:nowrap"/>
                    <ui:repeat var="range" value="#{item.ranges}">
                           <span style="display:block">
                                    <strong><h:outputText value="#{checksum.methodName}"
                                                          style="white-space:nowrap"/></strong>
                          <h:outputText value="#{range}" style="white-space:nowrap"/>
                               <br/>
                          </span>
                    </ui:repeat>
                </h:panelGroup>
            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="stcACol" rendered="#{columnContext.isColumnVisible('moleculeA.stc')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.stc']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <ui:repeat var="stc" value="#{binaryInteraction.interactorA.stoichiometry}">
            <h:outputText value="#{stc}" style="white-space:nowrap"/>
        </ui:repeat>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="stcBCol" rendered="#{columnContext.isColumnVisible('moleculeB.stc')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.stc']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <ui:repeat var="stc" value="#{binaryInteraction.interactorB.stoichiometry}">
            <h:outputText value="#{stc}" style="white-space:nowrap"/>
        </ui:repeat>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>


<p:column id="bioroleACol" rendered="#{columnContext.isColumnVisible('moleculeA.biorole')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.biorole']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorA.biologicalRoles[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvBiologicalRole"
                        cvIdentifier="#{binaryInteraction.interactorA.biologicalRoles[0].identifier}"/>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>
<p:column id="bioroleBCol" rendered="#{columnContext.isColumnVisible('moleculeB.biorole')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.biorole']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorB.biologicalRoles[0].text}" dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvBiologicalRole"
                        cvIdentifier="#{binaryInteraction.interactorB.biologicalRoles[0].identifier}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="pmethodACol" rendered="#{columnContext.isColumnVisible('moleculeA.pmethod')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.pmethod']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorA.participantIdentificationMethods[0].text}"
                        dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvIdentification"
                        cvIdentifier="#{binaryInteraction.interactorA.participantIdentificationMethods[0].identifier}"/>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>
<p:column id="pmethodBCol" rendered="#{columnContext.isColumnVisible('moleculeB.pmethod')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.pmethod']}"/></f:facet>

    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iv:cvLazyPopup text="#{binaryInteraction.interactorB.participantIdentificationMethods[0].text}"
                        dialogVar="cvInfoDialog"
                        cvClassName="uk.ac.ebi.intact.model.CvIdentification"
                        cvIdentifier="#{binaryInteraction.interactorB.participantIdentificationMethods[0].identifier}"/>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="xrefACol" rendered="#{columnContext.isColumnVisible('moleculeA.xrefs')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.xrefs']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorA.xrefs}"
                                 maxShown="3">
            <ui:param name="xrefUrl" value="#{iav:xrefUrl(appConfigBean.linkContext, item)}"/>
            <h:outputLink value="#{xrefUrl}" title="#{item.text}"
                          target="_blank"
                          disabled="#{xrefUrl == null or xrefUrl == '#'}">#{item.identifier}</h:outputLink>
        </iam:collapsibleIterator>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="xrefBCol" rendered="#{columnContext.isColumnVisible('moleculeB.xrefs')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.xrefs']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorB.xrefs}"
                                 maxShown="3">
            <ui:param name="xrefUrl" value="#{iav:xrefUrl(appConfigBean.linkContext, item)}"/>
            <h:outputLink value="#{xrefUrl}" title="#{item.text}"
                          target="_blank"
                          disabled="#{xrefUrl == null or xrefUrl == '#'}">#{item.identifier}</h:outputLink>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="xrefsCol" rendered="#{columnContext.isColumnVisible('interaction.xrefs')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.xrefs']}"/></f:facet>
    <iam:collapsibleIterator disclosed="false"
                             value="#{binaryInteraction.xrefs}"
                             maxShown="3">
        <ui:param name="xrefUrl" value="#{iav:xrefUrl(appConfigBean.linkContext, item)}"/>
        <h:outputLink value="#{xrefUrl}" title="#{item.text}"
                      target="_blank" disabled="#{xrefUrl == null or xrefUrl == '#'}">#{item.identifier}</h:outputLink>
    </iam:collapsibleIterator>
</p:column>

<p:column id="annotACol" rendered="#{columnContext.isColumnVisible('moleculeA.annotations')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeA.annotations']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorA.annotations}"
                                 maxShown="3">
            <span style="display:block">
                <strong><h:outputText value="#{item.topic}"/></strong>
                                    <h:outputText value=" : #{item.text}" rendered="#{item.text != null}"/>
                            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>

    <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="annotBCol" rendered="#{columnContext.isColumnVisible('moleculeB.annotations')}"
          styleClass="cellTextCompound">
    <f:facet name="header"><h:outputText value="#{messages['moleculeB.annotations']}"/></f:facet>
    <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
        <iam:collapsibleIterator disclosed="false"
                                 value="#{binaryInteraction.interactorB.annotations}"
                                 maxShown="3">
            <span style="display:block">
                               <strong><h:outputText value="#{item.topic}"/></strong>
                                <h:outputText value=" : #{item.text}" rendered="#{item.text != null}"/>
                            </span>
        </iam:collapsibleIterator>
    </h:panelGroup>
    <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
        <h:outputText value="N/A"/>
    </h:panelGroup>
</p:column>

<p:column id="annotsCol" rendered="#{columnContext.isColumnVisible('interaction.annotations')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['interaction.annotations']}"/></f:facet>
    <iam:collapsibleIterator disclosed="false"
                             value="#{binaryInteraction.annotations}"
                             maxShown="3">
            <span style="display:block">
                <strong><h:outputText value="#{item.topic}"/></strong>
                                    <h:outputText value=" : #{item.text}" rendered="#{item.text != null}"/>
                            </span>
    </iam:collapsibleIterator>
</p:column>

<p:column id="createdDateCol" rendered="#{columnContext.isColumnVisible('created.date')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['created.date']}"/></f:facet>
    <ui:repeat var="created" value="#{binaryInteraction.creationDate}">
                            <span style="display:block">
                                    <h:outputText value="#{iamf:formatDate(created)}" style="white-space:nowrap"/>
                            </span>
    </ui:repeat>
</p:column>

<p:column id="updateDateCol" rendered="#{columnContext.isColumnVisible('update.date')}"
          styleClass="cellTextInteraction">
    <f:facet name="header"><h:outputText value="#{messages['update.date']}"/></f:facet>
    <ui:repeat var="updated" value="#{binaryInteraction.updateDate}">
                            <span style="display:block">
                                    <h:outputText value="#{iamf:formatDate(updated)}" style="white-space:nowrap"/>
                            </span>
    </ui:repeat>
</p:column>
</p:dataTable>

<p:dataTable id="fourthTable" value="binaryInteraction">
    <p:column id="checksumACol" rendered="#{columnContext.isColumnVisible('moleculeA.checksum')}"
              styleClass="cellTextCompound">
        <f:facet name="header"><h:outputText value="#{messages['moleculeA.checksum']}"/></f:facet>
        <h:panelGroup rendered="#{binaryInteraction.interactorA != null}">
            <ui:repeat var="checksum" value="#{binaryInteraction.interactorA.checksums}" rows="0">
                           <span style="display:block">
                                    <strong><h:outputText value="#{checksum.methodName}"
                                                          style="white-space:nowrap"/></strong>
                                    <h:outputText value=" : #{checksum.checksum}" style="white-space:nowrap"/>
                            </span>
            </ui:repeat>
        </h:panelGroup>

        <h:panelGroup rendered="#{binaryInteraction.interactorA == null}">
            <h:outputText value="N/A"/>
        </h:panelGroup>
    </p:column>

    <p:column id="checksumBCol" rendered="#{columnContext.isColumnVisible('moleculeB.checksum')}"
              styleClass="cellTextCompound">
        <f:facet name="header"><h:outputText value="#{messages['moleculeB.checksum']}"/></f:facet>
        <h:panelGroup rendered="#{binaryInteraction.interactorB != null}">
            <ui:repeat var="checksum" value="#{binaryInteraction.interactorB.checksums}" rows="0">
                           <span style="display:block">
                                    <strong><h:outputText value="#{checksum.methodName}"
                                                          style="white-space:nowrap"/></strong>
                                    <h:outputText value=" : #{checksum.checksum}" style="white-space:nowrap"/>
                            </span>
            </ui:repeat>
        </h:panelGroup>

        <h:panelGroup rendered="#{binaryInteraction.interactorB == null}">
            <h:outputText value="N/A"/>
        </h:panelGroup>
    </p:column>

    <p:column id="checksumCol" rendered="#{columnContext.isColumnVisible('interaction.checksum')}"
              styleClass="cellTextInteraction">
        <f:facet name="header"><h:outputText value="#{messages['interaction.checksum']}"/></f:facet>
        <ui:repeat var="checksum" value="#{binaryInteraction.checksums}" rows="0">
                           <span style="display:block">
                                    <strong><h:outputText value="#{checksum.methodName}"
                                                          style="white-space:nowrap"/></strong>
                                    <h:outputText value=" : #{checksum.checksum}" style="white-space:nowrap"/>
                            </span>
        </ui:repeat>
    </p:column>
</p:dataTable>

</p:rowExpansion>
</p:dataTable>
</ui:composition>
