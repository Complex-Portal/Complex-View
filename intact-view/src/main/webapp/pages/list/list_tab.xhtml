<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:tr="http://myfaces.apache.org/trinidad"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:sf="http://www.ebi.ac.uk/faces/site"
                xmlns:ebi="http://ebi.ac.uk/faces/components"
                xmlns:bs="http://intact.ebi.ac.uk/binarysearch"
                xmlns:iav="http://intact.ebi.ac.uk/view"
                xmlns:iax="http://intact.ebi.ac.uk/extlinks">

<tr:messages/>

<tr:panelHeader text="Interactors">

<!-- RESULT SUMMARY -->

<tr:panelGroupLayout layout="vertical" id="searchSummary">

    <tr:group>
        <strong>Query: </strong>
        <ebi:outputText id="queryText" value="#{searchBean.searchQuery}" maxLength="50"
                        expandMessage="(see entire query)" collapseMessage="(collapse)"/>
    </tr:group>

    <tr:group>
        <strong>Lucene Query: </strong>
        <ebi:outputText id="luceneQueryText" value="#{searchBean.interactorResults.result.luceneQuery}" maxLength="50"
                        expandMessage="(see entire query)" collapseMessage="(collapse)"/>
    </tr:group>

    <tr:group>
        <strong>Interactors: </strong>#{searchBean.interactorResults.rowCount}
    </tr:group>

    <tr:group>
        <strong>Search time: </strong>
        <h:outputText value="#{searchBean.interactorResults.elapsedTimeSecs}">
            <f:convertNumber maxFractionDigits="2" minFractionDigits="2"/>
        </h:outputText>
        <h:outputText value=" seconds"/>
    </tr:group>

</tr:panelGroupLayout>


<br/>

<!-- RESULTS TABLE -->

<tr:table id="listResults" value="#{searchBean.interactorResults}" var="binaryInteraction" varStatus="status"
          summary="Binary Interactions"
          binding="#{searchBean.interactorBindings.resultsDataTable}" emptyText="No interactions found matching the query."
          rows="#{searchBean.pageSize}" rowBandingInterval="1"
          rowSelection="multiple" >

<f:facet name="actions">
    <tr:panelHorizontalLayout inlineStyle="width:100%">
        <f:facet name="separator">
            <tr:outputFormatted value="&#160;&#160;&lt;b>|&lt;/b>&#160;&#160;"/>
        </f:facet>

        <tr:panelHorizontalLayout>
             <f:facet name="separator">
                <tr:outputFormatted value="&#160;"/>
            </f:facet>
            <strong>
                 <tr:outputText value="Selection actions: "/>
            </strong>
            <tr:commandLink text="Search interactions"
                            actionListener="#{searchBean.doSearchInteractionsFromListSelection}"
                            action="main"/>
        </tr:panelHorizontalLayout>

    </tr:panelHorizontalLayout>
</f:facet>

<tr:column>
    <tr:outputText value="#{status.index + 1}"/>
</tr:column>

<tr:column headerText="Accession number/s" sortable="true" sortProperty="idA_s">
    <bs:xrefDataList value="#{binaryInteraction.interactorA.identifiers}"/>
</tr:column>
<tr:column headerText="Interactor Type" sortable="true"
           sortProperty="typeA_s">
    <bs:xrefDataList value="#{binaryInteraction.interactorTypeA}" onlyText="true"/>
</tr:column>
<tr:column headerText="Alternative id/s" sortable="true" sortProperty="altidA_s">
    <bs:xrefDataList value="#{binaryInteraction.interactorA.alternativeIdentifiers}" disableLinks="true"/>
</tr:column>
<tr:column headerText="Names" sortable="true" sortProperty="aliasA_s">
    <tr:iterator var="alias" value="#{binaryInteraction.interactorA.aliases}" varStatus="rowStatus">
        <h:outputText value="#{alias.name}"/>
        <h:outputText value=", " rendered="#{rowStatus.index + 1 lt rowStatus.count}"/>
    </tr:iterator>
</tr:column>
<tr:column headerText="Species" sortable="true" sortProperty="taxidA_s">
    <tr:iterator var="organism" value="#{binaryInteraction.interactorA.organism}">
        <tr:iterator var="xref" value="#{organism.identifiers}" varStatus="rowStatus">
            <iax:goOls query="#{xref.identifier}" termName="#{xref.text}"/>
        </tr:iterator>
        <h:outputText value=", " rendered="#{rowStatus.index + 1 lt rowStatus.count}"/>
    </tr:iterator>
</tr:column>

<!--<tr:column headerText="Interaction AC" sortable="true" sortProperty="interaction_id_s">-->
    <!--<bs:xrefDataList value="#{binaryInteraction.interactionAcs}" itemPerLine="true" disableLinks="true"/>-->
<!--</tr:column>-->

<tr:column sortable="true" sortProperty="propertiesA_s">
    <f:facet name="header">
        <tr:panelGroupLayout layout="vertical">
            <tr:outputText value="Properties molecule A"/>
        </tr:panelGroupLayout>
    </f:facet>
    <bs:xrefDataList value="#{binaryInteraction.propertiesA}"/>

</tr:column>

<tr:column headerText="Interactor type" rendered="#{searchBean.expandedView}" sortable="true"
           sortProperty="typeA_s">
    <bs:xrefDataList value="#{binaryInteraction.interactorTypeA}" onlyText="true"/>
</tr:column>


</tr:table>


</tr:panelHeader>

</ui:composition>