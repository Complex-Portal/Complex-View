<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:tr="http://myfaces.apache.org/trinidad"
                xmlns:trh="http://myfaces.apache.org/trinidad/html"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:sf="http://www.ebi.ac.uk/faces/site"
                xmlns:ebi="http://ebi.ac.uk/faces/components"
                xmlns:iam="http://intact.ebi.ac.uk/miscel"
                xmlns:iav="http://intact.ebi.ac.uk/view"
                xmlns:iax="http://intact.ebi.ac.uk/extlinks"
                xmlns:o="http://myfaces.apache.org/orchestra">

    <tr:spacer width="1" height="10"/>

    <!--<tr:panelHeader text="Quick Search" styleClass="level-one">-->


    <!--<tr:commandButton text="Clear search" actionListener="#{userQuery.clearSearchFilters}"/>-->

    <tr:panelHorizontalLayout valign="top">

        <f:facet name="separator">
            <tr:spacer width="10" height="1"/>
        </f:facet>

        <tr:panelGroupLayout>

            <tr:panelBox text="Quick search" background="dark" inlineStyle="width:100%">

                <tr:panelLabelAndMessage label="Search query:">
                    <tr:inputText columns="30" value="#{userQuery.searchQuery}"
                                  onfocus="this.select()"
                                  onkeypress="return submitEnter('mainSearchSubform:searchBtn',event)"/>
                    <f:facet name="help">
                        <tr:group>
                            <tr:panelList>
                                <tr:group>
                                    Protein accession number: e.g.&#160;
                                    <tr:commandLink text="P20053" action="#{searchBean.doNewBinarySearch}">
                                        <f:setPropertyActionListener value="P20053" target="#{userQuery.searchQuery}"/>
                                    </tr:commandLink>
                                </tr:group>
                                <tr:group>
                                    Drug name: e.g.&#160;
                                    <tr:commandLink text="imatinib" action="#{searchBean.doNewBinarySearch}">
                                        <f:setPropertyActionListener value="imatinib"
                                                                     target="#{userQuery.searchQuery}"/>
                                    </tr:commandLink>
                                </tr:group>
                                <tr:group>
                                    Gene name: e.g.&#160;
                                    <tr:commandLink text="DDR1" action="#{searchBean.doNewBinarySearch}">
                                        <f:setPropertyActionListener value="DDR1" target="#{userQuery.searchQuery}"/>
                                    </tr:commandLink>
                                </tr:group>
                            </tr:panelList>
                        </tr:group>
                    </f:facet>
                    <f:facet name="end">
                        <tr:commandButton id="searchBtn"
                                          text="Search"
                                          action="#{searchBean.doNewBinarySearch}"
                                          styleClass="submit_button"/>
                    </f:facet>
                </tr:panelLabelAndMessage>

            </tr:panelBox>

            <tr:spacer width="1" height="10"/>

            <tr:panelBox text="Ontology Search" background="dark" inlineStyle="width:100%">

                <tr:outputText value="Start typing an ontology term, possible completions of the term will be shown:"/>
                <br/><br/>


                <tr:panelLabelAndMessage label="Ontology query:">
                    <iam:inputAutocomplete id="ontologySearchQuery"
                                           value="#{userQuery.ontologySearchQuery}"
                                           columns="30"
                                           readOnly="false"
                                           locateBackingBean="#{ontologyBean}"
                                           locateActionListenerName="fillAutocomplete"
                                           locateValueFieldName="identifier"
                                           locateVisibleFieldName="identifier"
                                           maxSuggestions="#{intactViewConfiguration.maxOntologySuggestions}"
                                           var="ontologyTerm">

                        <span style="font-weight:bold; color: #e65555; display:inline;">#{ontologyTerm.identifier}</span>
                        <span style="display:inline;">#{ontologyTerm.label}</span>
                        <span style="font-weight:bold; color: #00cc99; display:inline;">(#{ontologyTerm.count})</span>

                    </iam:inputAutocomplete>

                    <f:facet name="help">
                        <tr:group>
                            <tr:panelList>
                                <tr:group>
                                    <tr:outputText value="Term name:"/>
                                    <tr:spacer width="5"/>
                                    <tr:commandLink text="2 hybrid" action="#{searchBean.doNewOntologySearch}">
                                        <f:setPropertyActionListener value="2 hybrid"
                                                                     target="#{userQuery.ontologySearchQuery}"/>
                                    </tr:commandLink>
                                </tr:group>

                                <tr:group>
                                    <tr:outputText value="Term identifier:"/>
                                    <tr:spacer width="5"/>
                                    <tr:commandLink text="MI:0019" action="#{searchBean.doNewOntologySearch}">
                                        <f:setPropertyActionListener value="MI:0019"
                                                                     target="#{userQuery.ontologySearchQuery}"/>
                                    </tr:commandLink>
                                    <tr:spacer width="5"/>
                                    <tr:outputText value="(coimmunoprecipitation)"/>
                                </tr:group>
                            </tr:panelList>
                        </tr:group>
                    </f:facet>
                    <f:facet name="end">
                        <tr:commandButton id="ontologySearchBtn"
                                          text="Search"
                                          action="#{searchBean.doNewOntologySearch}"
                                          styleClass="submit_button"/>
                    </f:facet>
                </tr:panelLabelAndMessage>

                <tr:panelLabelAndMessage label="Note: ">
                    <tr:outputText value="Currently the following ontologies are supported : "/>
                    <tr:goLink text="Gene Ontology"
                               destination="http://www.ebi.ac.uk/ontology-lookup/browse.do?ontName=GO"
                               targetFrame="_blank"/>
                    <tr:outputText value=", "/>
                    <tr:goLink text="PSI-MI" destination="http://www.ebi.ac.uk/ontology-lookup/browse.do?ontName=MI"
                               targetFrame="_blank"/>
                    <tr:outputText value=", "/>
                    <tr:goLink text="CHEBI" destination="http://www.ebi.ac.uk/ontology-lookup/browse.do?ontName=CHEBI"
                               targetFrame="_blank"/>
                    <tr:outputText value=" and "/>
                    <tr:goLink text="InterPro" destination="http://www.ebi.ac.uk/interpro/" targetFrame="_blank"/>

                </tr:panelLabelAndMessage>

                <br/>

                <tr:panelAccordion discloseNone="true">
                    <tr:showDetailItem text="Why do I find more interactions using the Ontology Search ?" immediate="true">
                        <br/>
                        The ontology search is designed to provide search facilities on a given set of ontologies.
                        Furthermore, whenever you search for a given ontology term, it also includes the interactions of
                        all children that may have been used to annotate participants of these interactions.
                        <br/>
                        <br/>
                        <u>Example</u>: Let's look at a GO term like synapse (GO:0045202), when searching for synapse in the
                        Ontology Search, we actually search for that term but also all of its children as depicted below:
                        
                        <blockquote><tr:image source="/images/documentation/go_synapse.png" /></blockquote>

                        However, when searching for that same term in Quick Search, we will only present you with the
                        interactions for which this and only this term was found.
                    </tr:showDetailItem>
                </tr:panelAccordion>

            </tr:panelBox>
        </tr:panelGroupLayout>


        <tr:panelGroupLayout>
            <ui:include src="filters.xhtml"/>
        </tr:panelGroupLayout>

    </tr:panelHorizontalLayout>

    <!--</tr:panelHeader>-->

    <tr:panelHeader text="Other Searches">

        <tr:panelAccordion discloseNone="true">
            <!--<tr:showDetailItem text="Protein Sequence Search (Not implemented)">-->
            <!--<h:panelGrid columns="2">-->
            <!--<tr:outputText value="Paste in an amino acid sequence in Fasta format."/>-->
            <!--<tr:spacer/>-->
            <!--<tr:inputText rows="5" disabled="true"/>-->
            <!--<tr:panelBox id="searchExampleBox" text="Examples">-->
            <!-- TODO how to display this a <pre> block -->
            <!-- TODO how to align this cell to the top ? -->
            <!--<tr:outputText-->
            <!--value="&lt;pre&gt;&gt;GI1234&lt;br&gt;ATYEEEJK&lt;/pre&gt;" escape="false"/>-->
            <!--</tr:panelBox>-->

            <!--</h:panelGrid>-->
            <!--</tr:showDetailItem>-->
            <tr:showDetailItem text="Chemical Search">
                <iframe frameborder="0" width="900" height="1100"
                        src="#{intactViewConfiguration.chebiUrl}#{intactViewConfiguration.chebiChemicalSearchPath}&amp;callbackUrl=#{requestConfigBean.encodedCallBackUrl}"/>

            </tr:showDetailItem>
        </tr:panelAccordion>

    </tr:panelHeader>

</ui:composition>