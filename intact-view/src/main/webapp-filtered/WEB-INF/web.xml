<?xml version = '1.0' encoding = 'ISO-8859-1'?>
<!--
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or impliedor.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
-->
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         metadata-complete="false"
         version="2.5">
    
    <!-- IntAct -->
    <context-param>
        <param-name>intact.APPLICATION_ROOT</param-name>
        <param-value>${appRoot}</param-value>
    </context-param>
    
    <context-param>
        <description>
            Where to find the Menu XML file
        </description>
        <param-name>uk.ac.ebi.faces.MENU_URL</param-name>
        <param-value>${intact.menu.url}</param-value>
    </context-param>
     <context-param>
        <description>
            Where to find the News XML file
        </description>
        <param-name>uk.ac.ebi.faces.NEWS_URL</param-name>
        <param-value>${intact.news.url}</param-value>
    </context-param>
    <context-param>
        <description>
            Number of pieces of news shown in the sidebar panel
        </description>
        <param-name>uk.ac.ebi.intact.NEWS_SHOWN_NUM</param-name>
        <param-value>2</param-value>
    </context-param>

    <context-param>
        <description>
            Configuration file
        </description>
        <param-name>psidev.DEFAULT_CONFIG_FILE</param-name>
        <param-value>${binarysearch.config}</param-value>
    </context-param>
    <context-param>
        <description>
            Default index location
        </description>
        <param-name>psidev.DEFAULT_INDEX</param-name>
        <param-value>${binarysearch.defaultindex}</param-value>
    </context-param>

    <context-param>
        <description>
            URL to the Hierarch View servlet that generate the images
        </description>
        <param-name>binarysearch.HIERARCH_VIEW_DISPLAY_URL</param-name>
        <param-value>${intact.hierarchview.url}/display.do?</param-value>
    </context-param>
    <context-param>
        <description>
            URL to the Hierarch View servlet that generate the images
        </description>
        <param-name>binarysearch.HIERARCH_VIEW_GENERATEIMAGE_URL</param-name>
        <param-value>${intact.hierarchview.url}/GenerateImage?</param-value>
    </context-param>

     <context-param>
        <description>
            Maximum number of interactions for the image to show
        </description>
        <param-name>binarysearch.MAX_INTERACTIONS_FOR_IMAGE</param-name>
        <param-value>500</param-value>
    </context-param>
    <context-param>
        <description>
            Secret key to decode
        </description>
        <param-name>psidev.SECRET</param-name>
        <param-value>Nzk4NDMyMTW=</param-value>
    </context-param>
    <context-param>
        <description>
            Maximum number of results after executing a search query. Default: 153600 (150*1024)
        </description>
        <param-name>psidev.MAX_SEARCH_RESULTS</param-name>
        <param-value>153600</param-value>
    </context-param>
    <context-param>
        <description>
            Don't fetch the Controlled vocabularies from OLS. Note that if this is true, the ability
            to get the children of a detection method or interaction type is not possible. Default: false
        </description>
        <param-name>psidev.DO_NOT_USE_OLS</param-name>
        <param-value>true</param-value>
    </context-param>

    <!-- MyFaces -->

    <context-param>
           <description>Comma separated list of URIs of (additional) faces config files.
               (e.g. /WEB-INF/my-config.xml)
               See JSF 1.0 PRD2, 10.3.2
               Attention: You do not need to put /WEB-INF/faces-config.xml in here.
           </description>
           <param-name>javax.faces.CONFIG_FILES</param-name>
           <param-value>/WEB-INF/navigation-faces-config.xml</param-value>
       </context-param>
       <context-param>
           <description>State saving method: "client" or "server" (= default)
               See JSF Specification 2.5.3</description>
           <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
           <param-value>client</param-value>
       </context-param>
       <context-param>
           <description>Only applicable if state saving method is "server" (= default).
               Defines the amount (default = 20) of the latest views are stored in session.</description>
           <param-name>org.apache.myfaces.NUMBER_OF_VIEWS_IN_SESSION</param-name>
           <param-value>20</param-value>
       </context-param>
       <context-param>
           <description>Only applicable if state saving method is "server" (= default).
               If true (default) the state will be serialized to a byte stream before it
               is written to the session.
               If false the state will not be serialized to a byte stream.</description>
           <param-name>org.apache.myfaces.SERIALIZE_STATE_IN_SESSION</param-name>
           <param-value>true</param-value>
       </context-param>
       <context-param>
           <description>Only applicable if state saving method is "server" (= default) and if
               org.apache.myfaces.SERIALIZE_STATE_IN_SESSION is true (= default)
               If true (default) the serialized state will be compressed before it
               is written to the session. If false the state will not be compressed.</description>
           <param-name>org.apache.myfaces.COMPRESS_STATE_IN_SESSION</param-name>
           <param-value>true</param-value>
       </context-param>
       <context-param>
           <description>This parameter tells MyFaces if javascript code should be allowed in the
               rendered HTML output.
               If javascript is allowed, command_link anchors will have javascript code
               that submits the corresponding form.
               If javascript is not allowed, the state saving info and nested parameters
               will be added as url parameters.
               Default: "true"</description>
           <param-name>org.apache.myfaces.ALLOW_JAVASCRIPT</param-name>
           <param-value>true</param-value>
       </context-param>
       <context-param>
           <param-name>org.apache.myfaces.DETECT_JAVASCRIPT</param-name>
           <param-value>false</param-value>
       </context-param>
       <context-param>
           <description>If true, rendered HTML code will be formatted, so that it is "human readable".
               i.e. additional line separators and whitespace will be written, that do not
               influence the HTML code.
               Default: "true"</description>
           <param-name>org.apache.myfaces.PRETTY_HTML</param-name>
           <param-value>true</param-value>
       </context-param>
       <context-param>
           <description>If true, a javascript function will be rendered that is able to restore the
               former vertical scroll on every request. Convenient feature if you have pages
               with long lists and you do not want the browser page to always jump to the top
               if you trigger a link or button action that stays on the same page.
               Default: "false"</description>
           <param-name>org.apache.myfaces.AUTO_SCROLL</param-name>
           <param-value>true</param-value>
       </context-param>

       <context-param>
           <description>Used for encrypting view state. Only relevant for client side
               state saving. See MyFaces wiki/web site documentation for instructions
               on how to configure an application for diffenent encryption strengths.
           </description>
           <param-name>org.apache.myfaces.SECRET</param-name>
           <param-value>NzY1NDMyMTA=</param-value>
       </context-param>

       <context-param>
           <description>
               Validate managed beans, navigation rules and ensure that forms are not nested.
           </description>
           <param-name>org.apache.myfaces.VALIDATE</param-name>
           <param-value>true</param-value>
       </context-param>



    <!-- Facelets -->

  <context-param>
    <param-name>org.apache.myfaces.trinidad.ALTERNATE_VIEW_HANDLER</param-name>
    <param-value>com.sun.facelets.FaceletViewHandler</param-value>
  </context-param>

  <context-param>
    <param-name>facelets.DEVELOPMENT</param-name>
    <param-value>true</param-value>
  </context-param>

    <!-- Spring resources -->
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        classpath*:*.spring.xml
    </param-value>
  </context-param>

  <!-- Use Documents Saved as *.xhtml -->
  <context-param>
    <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
    <param-value>.xhtml</param-value>
  </context-param>

    <!-- Facelets -->
    <context-param>
        <param-name>facelets.SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>

  <context-param>
    <param-name>facelets.LIBRARIES</param-name>
    <param-value>/WEB-INF/intactview.taglib.xml;
                /WEB-INF/intact-functions.taglib.xml;
                /WEB-INF/extlinks.taglib.xml;
                /WEB-INF/binarysearch.taglib.xml;
                /WEB-INF/psimitab.taglib.xml
    </param-value>
  </context-param>


    <!-- Trinidad -->

    <!-- Trinidad also supports an optimized strategy for caching some
   view state at an application level, which significantly improves
   scalability.  However, it makes it harder to develop (updates to
   pages will not be noticed until the server is restarted), and in
   some rare cases cannot be used for some pages (see Trinidad
   documentation for more information) -->
  <context-param>
    <param-name>org.apache.myfaces.trinidad.USE_APPLICATION_VIEW_CACHE</param-name>
    <param-value>false</param-value>
  </context-param>

    <!-- If this parameter is enabled, Trinidad will automatically
       check the modification date of your JSPs, and discard saved
       state when they change;  this makes development easier,
       but adds overhead that should be avoided when your application
       is deployed -->
  <context-param>
    <param-name>org.apache.myfaces.trinidad.CHECK_FILE_MODIFICATION</param-name>
    <param-value>true</param-value>
  </context-param>

  <!-- Enables Change Persistence at a session scope.  By default,
       Change Persistence is entirely disabled. The ChangeManager is
       an API, which can persist component modifications (like,
       is a showDetail or tree expanded or collapsed). For providing
       a custom Change Persistence implementation inherit from the
       Trinidad API's ChangeManager class. As the value you have
       to use the fullqualified class name. -->
  <context-param>
    <param-name>org.apache.myfaces.trinidad.CHANGE_PERSISTENCE</param-name>
    <param-value>session</param-value>
  </context-param>


    <context-param>
        <param-name>org.apache.myfaces.trinidad.DISABLE_CONTENT_COMPRESSION</param-name>
        <param-value>true</param-value>
    </context-param>
    <context-param>
        <param-name>org.apache.myfaces.trinidad.ENABLE_LIGHTWEIGHT_DIALOGS</param-name>
        <param-value>true</param-value>
    </context-param>

  <!-- Orchestra Filter -->
  <filter>
    <filter-name>orchestraFilter</filter-name>
    <filter-class>org.apache.myfaces.orchestra.conversation.jsf.filter.OrchestraServletFilter</filter-class>
  </filter>

  <filter-mapping>
    <filter-name>orchestraFilter</filter-name>
    <servlet-name>faces</servlet-name>
  </filter-mapping>

  <filter>
    <filter-name>trinidad</filter-name>
    <filter-class>org.apache.myfaces.trinidad.webapp.TrinidadFilter</filter-class>
  </filter>

  <filter-mapping>
    <filter-name>trinidad</filter-name>
    <servlet-name>faces</servlet-name>
  </filter-mapping>

  <!-- IntAct Filter -->
  <filter>
    <filter-name>intactFilter</filter-name>
    <filter-class>uk.ac.ebi.intact.webapp.JpaIntactSessionRequestFilter</filter-class>
      <init-param>
          <param-name>uk.ac.ebi.intact.filter.MANUAL_TRANSACTION</param-name>
          <param-value>true</param-value>
      </init-param>
  </filter>

  <filter-mapping>
    <filter-name>intactFilter</filter-name>
    <servlet-name>faces</servlet-name>
  </filter-mapping>

    <!-- IntAct Core Startup-->
    <listener>
        <listener-class>uk.ac.ebi.intact.webapp.BasicStartupIntactListener</listener-class>
    </listener>

    <!-- App binary search listener -->
    <listener>
        <description>Listener to startup the application</description>
        <listener-class>uk.ac.ebi.intact.binarysearch.webapp.StartupListener</listener-class>
    </listener>

    <!-- Listener to force a garbage collection if too many files are open - Only works in UNIX -->
    <listener>
        <listener-class>uk.ac.ebi.faces.webapp.EvilOpenFilesListener</listener-class>
    </listener>

  <!-- Spring Framework 2.0 -->
  <listener>
    <listener-class>
      org.springframework.web.context.ContextLoaderListener
    </listener-class>
  </listener>

  <!-- Orchestra stuff -->
  <listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
  </listener>
  <listener>
	  <listener-class>org.apache.myfaces.orchestra.conversation.servlet.ConversationManagerSessionListener</listener-class>
  </listener>

  <!-- Faces Servlet -->
  <servlet>
    <servlet-name>faces</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
  </servlet>

  <!-- resource loader servlet -->
  <servlet>
    <servlet-name>resources</servlet-name>
    <servlet-class>org.apache.myfaces.trinidad.webapp.ResourceServlet</servlet-class>
  </servlet>

  <!-- Faces Servlet Mappings -->
  <servlet-mapping>
    <servlet-name>faces</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
  </servlet-mapping>

  <servlet-mapping>
    <servlet-name>resources</servlet-name>
    <url-pattern>/adf/*</url-pattern>
  </servlet-mapping>

    <!-- DAS Proxy Servlet -->
  <servlet>
    <servlet-name>das</servlet-name>
    <servlet-class>uk.ac.ebi.intact.services.search.das.DasProxyServlet</servlet-class>
  </servlet>

    <servlet-mapping>
    <servlet-name>das</servlet-name>
    <url-pattern>*.dasProxy</url-pattern>
  </servlet-mapping>

    <!-- Binary Search Servlets -->
      <servlet>
        <servlet-name>export</servlet-name>
        <servlet-class>uk.ac.ebi.intact.binarysearch.webapp.servlet.ExportServlet</servlet-class>
      </servlet>

      <servlet-mapping>
        <servlet-name>export</servlet-name>
        <url-pattern>/export</url-pattern>
      </servlet-mapping>

   <!-- Welcome files -->
    <welcome-file-list>
        <welcome-file>/index.jsp</welcome-file>
    </welcome-file-list>

    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>

    <!-- Handling of the HTTP error 404 -->
    <!--<error-page>-->
        <!--<error-code>404</error-code>-->
        <!--<location>/404_file_not_found.xhtml</location>-->
    <!--</error-page>-->
<!--
    <error-page>
        <error-code>500</error-code>
        <location>/500_server_error.html</location>
    </error-page>
-->


</web-app>
