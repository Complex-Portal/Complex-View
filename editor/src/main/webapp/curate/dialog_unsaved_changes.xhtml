<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.prime.com.tr/ui"
                xmlns:ia="http://java.sun.com/jsf/composite/components/intact">

    <p:dialog id="unsavedChangesDialog" widgetVar="unsavedChangesDialog" header="Unsaved changes" modal="true"
              position="center" 
              width="500">

        <p:dataTable id="unsavedTable" var="change" value="#{curatorContextController.allChanges}" paginator="true" rows="10"
                paginatorAlwaysVisible="false">
            <p:column>
                <h:commandButton value="Edit" action="#{curatorContextController.edit(change.unsavedObject)}"/>
            </p:column>
            <p:column>
                <f:facet name="header"><h:outputText value="Modification"/></f:facet>
                <h:outputText value="#{change.action}"/>
            </p:column>
            <p:column>
                <f:facet name="header"><h:outputText value="Class"/></f:facet>
                <h:outputText value="#{change.unsavedObject.class.simpleName}"/>
            </p:column>
            <p:column>
                <f:facet name="header"><h:outputText value="AC"/></f:facet>
                <h:outputText value="#{change.unsavedObject.ac}"/>
            </p:column>
            <p:column>
                <f:facet name="header"><h:outputText value="Description"/></f:facet>
                <h:outputText value="#{change.getDescription(change.unsavedObject)}"/>
            </p:column>


        </p:dataTable>

            <br/>

             <div class="dialogButtonBar">
                <p:commandButton value="Save All" actionListener="#{persistenceController.saveAll}"
                                 onclick="saveAllDlg.show()" oncomplete="unsavedChangesDialog.hide(); saveAllDlg.hide()"
                                 update="centralUnit,topSection,messagesComponent"/>
                 &#160;
                <p:commandLink value="Revert All" actionListener="#{persistenceController.revertAll}"
                               onclick="revertAllDlg.show()" oncomplete="unsavedChangesDialog.hide(); revertAllDlg.hide()"
                               update="centralUnit,topSection,messagesComponent"/>
            </div>

    </p:dialog>

    <ia:loadingDialog widgetVar="saveAllDlg" message="Saving all..."/>
    <ia:loadingDialog widgetVar="revertAllDlg" message="Saving all..."/>

</ui:composition>