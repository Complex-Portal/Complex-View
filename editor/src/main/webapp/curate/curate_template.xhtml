<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:p="http://primefaces.prime.com.tr/ui"

                template="/main_template.xhtml">

    <ui:define name="topNavigation">
        <ui:include src="/shared/top_navigation_bar.xhtml">
            <ui:param name="selected" value="curate"/>
        </ui:include>
    </ui:define>

    <ui:define name="topTitle">
        <h:panelGroup rendered="#{publicationController.publication != null}">
            <h:link outcome="/curate/publication" value="#{publicationController.firstAuthor} et al (#{publicationController.year})" rendered="#{publicationController.firstAuthor != null}"/>

            <h:panelGroup rendered="#{publicationController.publication.shortLabel != null}">
                (&#160;<h:outputText value="#{publicationController.publication.shortLabel}"/> )
            </h:panelGroup>
        </h:panelGroup>
    </ui:define>

    <ui:define name="top">
        <h:panelGroup rendered="#{publicationController.publication != null}">
            <div style="float: right">
                <p:commandButton value="Save" actionListener="#{publicationController.doSave}" ajax="false"/>

                <h:panelGroup rendered="#{publicationController.lastSaved != null}" style="color: #AAAAAA">
                    <h:outputText value=" Last Saved: " />
                    <h:outputText value="#{publicationController.lastSaved}">
                        <f:convertDateTime pattern="HH:mm (z)"/>
                    </h:outputText>
                </h:panelGroup>
            </div>
        </h:panelGroup>
    </ui:define>

    <ui:define name="content">
        <p:hotkey bind="alt+n" oncomplete="newPublicationDlg.show()"/>
        <p:hotkey bind="alt+o" oncomplete="openByPmidDlg.show()"/>

        <div id="menuSection" style="width:98%; position:fixed; margin-top: -10px; margin-left:-10px">
            <ui:insert name="menubar">
                <p:menubar>
                    <p:submenu label="Publication">
                        <p:submenu label="New" onclick="newPublicationDlg.show()" />
                        <p:submenu label="Open by PMID" onclick="openByPmidDlg.show()"/>
                        <p:menuitem label="Save" url="#" rendered="#{publicationController.publication != null}">
                            <p:commandLink value="Save" actionListener="#{publicationController.doSave}" ajax="false"/>
                        </p:menuitem>
                        <p:menuitem label="Save &amp; Close" url="#" rendered="#{publicationController.publication != null}">
                            <p:commandLink value="Save &amp; Close" actionListener="#{publicationController.doSaveAndClose}"
                                    action="/curate/curate" ajax="false"/>
                        </p:menuitem>
                    </p:submenu>
                    <p:submenu label="Experiments" rendered="#{publicationController.publication != null}"/>
                    <p:submenu label="Interactions" rendered="#{publicationController.publication != null}"/>
                </p:menubar>

            </ui:insert>
        </div>

        <br />


        <p:commandLink onclick="cvDlg.show();" value="CvDatabase" actionListener="#{cvController.load}">
            <f:setPropertyActionListener value="uk.ac.ebi.intact.model.CvDatabase" target="#{cvController.cvClass}"/>
        </p:commandLink>

        <!--<h:link onclick="cvDlg.show();" value="CvInteraction" includeViewParams="true">
           <f:param name="cvClass" value="uk.ac.ebi.intact.model.CvInteraction"/>
        </h:link>-->

        <ui:include src="cv_browser.xhtml"/>

        <br />

        <div style="width:100%; padding-top:30px">
            <ui:insert name="curateContent"/>
        </div>

    </ui:define>

    <ui:define name="dialogs">
        <ui:include src="menu_dialogs.xhtml"/>
    </ui:define>

</ui:composition>